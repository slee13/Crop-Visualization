@@ -3,7 +3,7 @@
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Test Force Bubble Charts</title>
    <title>Force Bubble Charts</title>
    <link href="css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
@@ -11,29 +11,26 @@
        padding-left: 50px;
      }
      circle {
        stroke: white;
        stroke-width: 2px;
        opacity: .8;
      }
      .btn-group {
        margin-left: 330px;
      }
      .label {
        fill: white;
        font-size: 16px;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <div class="btn-group" data-toggle="buttons">
      <label class="btn btn-primary active" id="Item">
        <input type="radio" name="options"> Item
      <label class="btn btn-primary active" id="Country">
        <input type="radio" name="options"> Country
      </label>
      <label class="btn btn-primary" id="Value">
        <input type="radio" name="options"> Value
      </label>
      <label class="btn btn-primary" id="Country">
        <input type="radio" name="options"> Country
      <label class="btn btn-primary" id="Item">
        <input type="radio" name="options"> Item
      </label>
    </div>
    <div id="chart"></div>
@@ -42,16 +39,24 @@
    <script src="lib/bootstrap.js"></script>
    <script src="lib/underscore.js"></script>
    <script>
      d3.csv('data/FAOSTAT_albania.csv', function (error, data) {
    //SVG filter for the gooey effect
    //Code based on http://tympanus.net/codrops/2015/03/10/creative-gooey-effects/


      d3.csv('data/FAOSTAT_meats.csv', function (error, data) {

        var width = 1000, height = 1000;
        var fill = d3.scale.ordinal().range(['#827d92','#827354','#523536','#72856a','#2a3285','#383435'])
        var fill = d3.scale.ordinal().range(['cyan','magenta','yellow','#72856a','#2a3285','#383435'])
        var svg = d3.select("#chart").append("svg")
            .attr("width", width)
            .attr("height", height);
            .attr("height", height)
            .style("filter", "url(#gooeyCodeFilter)");

        var max_amount = d3.max(data, function (d) { return parseInt(d.Value)})
        var radius_scale = d3.scale.pow().exponent(0.5).domain([0, max_amount]).range([2, 85])

        for (var j = 0; j < data.length; j++) {
          data[j].radius = +data[j].Value / 1000;
          data[j].radius = radius_scale(+data[j].Value)*.8;
          data[j].x = Math.random() * width;
          data[j].y = Math.random() * height;
        }
@@ -80,7 +85,7 @@
          .attr("cx", function (d) { return d.x; })
          .attr("cy", function (d) { return d.y; })
          .attr("r", 2)
          .style("fill", function (d) { return fill(d.Item); })
          .style("fill", function (d) { return fill(d.Country); })
          .on("mouseover", function (d) { showPopover.call(this, d); })
          .on("mouseout", function (d) { removePopovers(); })

@@ -89,7 +94,41 @@

        var force = d3.layout.force();

        draw('Item');
        var filter = svg.append("defs")
        .append("filter")
        .attr("id","gooeyCodeFilter"); //use a unique id to reference again later on

        //Append multiple "pieces" to the filter
        filter.append("feGaussianBlur")
        .attr("in","SourceGraphic")
        .attr("stdDeviation","10")
        //to fix safari:
        //http://stackoverflow.com/questions/24295043/svg-gaussian-blur-in-safari-unexpectedly-lightens-image
        .attr("color-interpolation-filters","sRGB")
        .attr("result","blur");
        filter.append("feColorMatrix")
        .attr("class","blurValues") //used later to transition the gooey effect
        .attr("in","blur")
        .attr("mode","matrix")
        .attr("values","1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9")
        .attr("result","gooey");
        //If you want the end shapes to be exactly the same size as without the filter
        //add the feBlend below. However this will result in a less beautiful gooey effect
        filter.append("feBlend")
        .attr("in","SourceGraphic")
        .attr("in2","gooey");
        //Instead of the feBlend, you can do feComposite. This will also place a sharp image on top
        //But it will result in smaller circles
        // filter.append("feComposite") //feBlend
        //   .attr("in","SourceGraphic")
        //   .attr("in2","gooey")
        //   .attr("operator","atop");

        //Apply the filter to the group element of all the circles
        var circleWrapper = svg.append("g")
        .style("filter", "url(#gooeyCodeFilter)");

        draw('Country');

        $( ".btn" ).click(function() {
          draw(this.id);
@@ -126,7 +165,7 @@
          svg.selectAll(".label")
          .data(centers).enter().append("text")
          .attr("class", "label")
          .text(function (d) { return d.Item })
          .text(function (d) { return d.name })
          .attr("transform", function (d) {
            return "translate(" + (d.x - ((d.name.length)*3)) + ", " + (d.y - d.r) + ")";
          });
